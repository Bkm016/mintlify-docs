---
title: "函数目录与补全"
description: "fluxon-functions.json 的生成流程与消费方式"
---

Fluxon 通过一份统一的 `fluxon-functions.json` 目录把运行时函数暴露给 IDE、脚本引擎与文档工具。目录由 `core` 模块在构建阶段导出，包含系统函数与扩展函数的元数据（命名空间、参数数量、是否异步等），之后由 VS Code 扩展、Mintlify 文档及其他自动化工具一同消费。

## 目录包含什么

目录文件遵循 `FunctionDumper` 的结构：

```json
{
	"generatedAt": "2025-11-15T08:35:12.123Z",
	"system": [
		{ "name": "print", "namespace": null, "params": [1], "async": false, "primarySync": true },
		{ "name": "sleep", "namespace": null, "params": [1], "async": false, "primarySync": false }
	],
	"extensions": {
		"java.io.File": [
			{ "name": "readText", "namespace": "fs:io", "params": [0], "async": false, "primarySync": true }
		]
	}
}
```

- `system`：直接以 `runtime.registerFunction` 注册的全局/命名空间函数。
- `extensions`：按宿主类型分组的扩展函数，供 IDE 在 `object::` 上下文提示。
- `params`：同名函数若支持多种参数个数，会列出所有合法值。
- `async`/`primarySync`：来自 Java 端 `Function` 定义，用于 IDE 区分 `await` 需求或只允许在主线程调用的 API。

## 如何生成

`core/build.gradle.kts` 暴露了 `dumpFluxonCatalog` 任务，实质上调用 `org.tabooproject.fluxon.tool.FunctionDumper`：

```bash
./gradlew :core:dumpFluxonCatalog
```

输出路径：`core/build/fluxon-functions.json`（可通过任务参数覆盖）。任务会：

1. 启动最小化的 `FluxonRuntime`。
2. 遍历注册在运行时的系统函数与扩展函数。
3. 将结果排序（按函数名、宿主类）后写入 JSON。

建议在以下场景重新执行该命令：

- 新增/删除运行时函数或扩展函数。
- 修改函数签名（参数个数、命名空间、异步属性）。
- 准备发布 VS Code 扩展或同步 Mintlify 文档前。